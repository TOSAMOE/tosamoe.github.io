<!DOCTYPE html>
<html lang="ru">
<head>
  <meta charset="UTF-8">
  <meta name="viewport" content="width=device-width, initial-scale=1.0">
  <title>Flappy Bird</title>
  <style>
    body {
      display: flex;
      justify-content: center;
      align-items: center;
      height: 100vh;
      margin: 0;
      background-color: #70c5ce;
    }

    canvas {
      background-color: #fff;
      border: 2px solid #000;
    }
  </style>
</head>
<body>
  <canvas id="canvas" width="320" height="480"></canvas>

  <script>
    const canvas = document.getElementById("canvas");
    const ctx = canvas.getContext("2d");

    // Загружаем изображения из локальной директории
    const birdImg = new Image();
    birdImg.src = "assets/camoletik.png"; // Локальная картинка птицы
    const bgImg = new Image();
    bgImg.src = "assets/kvadratik.png";  // Локальная картинка фона
    const pipeNorthImg = new Image();
    pipeNorthImg.src = "assets/kvadratik.png"; // Локальная картинка верхней трубы
    const pipeSouthImg = new Image();
    pipeSouthImg.src = "assets/kvadratik.png"; // Локальная картинка нижней трубы

    // Переменные
    let birdX = 50;
    let birdY = 150;
    let gravity = 1.5;
    let gap = 100;
    let constant;
    let score = 0;

    const pipes = [];
    pipes[0] = { x: canvas.width, y: 0 };

    // Управление
    document.addEventListener("keydown", moveUp);

    function moveUp() {
      birdY -= 30;
    }

    // Основной цикл игры
    function draw() {
      // Фон
      ctx.drawImage(bgImg, 0, 0);

      // Трубы
      for (let i = 0; i < pipes.length; i++) {
        constant = pipeNorthImg.height + gap;
        ctx.drawImage(pipeNorthImg, pipes[i].x, pipes[i].y);
        ctx.drawImage(pipeSouthImg, pipes[i].x, pipes[i].y + constant);

        pipes[i].x--;

        if (pipes[i].x === 120) {
          pipes.push({ x: canvas.width, y: Math.floor(Math.random() * pipeNorthImg.height) - pipeNorthImg.height });
        }

        // Столкновение
        if (
          (birdX + birdImg.width >= pipes[i].x && birdX <= pipes[i].x + pipeNorthImg.width &&
            (birdY <= pipes[i].y + pipeNorthImg.height || birdY + birdImg.height >= pipes[i].y + constant)) ||
          birdY + birdImg.height >= canvas.height
        ) {
          location.reload(); // Перезагрузка страницы при столкновении
        }

        if (pipes[i].x === 5) {
          score++;
        }
      }

      // Птица
      ctx.drawImage(birdImg, birdX, birdY);

      birdY += gravity;

      // Отображение счета
      ctx.fillStyle = "#000";
      ctx.font = "20px Verdana";
      ctx.fillText("Score: " + score, 10, canvas.height - 20);

      requestAnimationFrame(draw);
    }

    draw();
  </script>
</body>
</html>
